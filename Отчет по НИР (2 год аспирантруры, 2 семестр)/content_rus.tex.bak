\section{Введение}
ИЯФ СО РАН много лет занимается разработкой установок для рентгеновского досмотра \cite{SiPM based photon counting detector for scanning digital radiography}.
Данные установки можно использовать в различных областях: досмотр в аэропортах, метро или на предприятиях.
До настоящего времени в качестве детектора рентгеновского излучения использовалась многополосковая ионизационная камера повышенного давления (Xe, 15 атм).
Однако такой детектор имеет серьезный недостаток - он работает в интегрирующем режиме, поэтому при низких входных потоках частиц шум электроники существенно ухудшает качество получаемых изображений.
Другой недостаток - недостаточно высокая эффективность регистрации фотонов больших энергий.
В связи с этим было принято решение перейти на детектор, работающий в режиме прямого счета фотонов на основе SiPM и сцинтиллятора, который может иметь эффективность регистрации >90\%.

Основная цель данной работы - измерить вероятности послеимпульсов и кросстоков двух SiPM: KETEK PM1125NS-SB0 и Hamamatsu S13360-3050CS и сравнить их с характеристиками Hamamatsu S10362-11-100C - SiPM предыдущего поколения.

\section{Алгоритм нахождения кросстоков и послеимпульсов}
Существует несколько алгоритмов нахождения вероятностей кросстока.
Один из них описан в \cite{Characterisation Studies of Silicon Photomultipliers}.
Идея заключается в измерении частоты темнового тока при различных порогах.
Вероятность кросстока можно найти как отношение частот при пороге 1.5 фотоэлектрона и 0.5 фотоэлектрона:
\begin{eqnarray}\label{eq:X_talk}
P_{X-talk} = \nu_{1.5 pe} / \nu_{0.5 pe}
\end{eqnarray}
Однако этот метод имеет существенный недостаток: послеимпульсы неотличимы  от кросстока, если первые выше установленного порога.
Кроме того, такой алгоритм не использует информацию о форме сигнала, что делает зависимость частоты от порога более размытой и
усложняет нахождение величины $\nu_{1.5 pe}$.

Более сложный алгоритм должен использовать информацию о форме сигнала.
Здесь существуют два подхода к обработке сигнала: обратная свертка \cite{Modeling crosstalk in silicon photomultipliers} и аппроксимация исходного сигнала \cite{Characterization and Simulation of the Response, After-pulsingandcross-talkinmulti-pixelphotoncounters, Using MPPCs for T2K Fine Grain Detector}.

В процессе аппроксимации сигнала мы получим амплитуду и время начала сигнала.
Используя эту информацию, можно восстановить постоянную времени послеимпульса и вероятность послеимпульса.

Послеимпульс - повторное срабатывание ячейки, происходящее через некоторый промежуток времени после её срабатывания.
Причина появления послеимпульсов заключается в захвате электронов в ловушки во время лавины с их последующим высвобождение через промежуток времени от нескольких наносекунд до нескольких микросекунд \cite{Characterisation Studies of Silicon Photomultipliers}.

Существует несколько процессов, которые могут вызвать повторное срабатывание ячейки.
Во-первых, это послеимпульсы. Из-за наличия различных физических механизмов образования электронных ловушек существуют два вида
послеимпульсов: с быстрой и медленной компонентой \cite{After-pulsingandcross-talkinmulti-pixelphotoncounters, Using MPPCs for T2K Fine Grain Detector, Characterization and Simulation of the Response}.
Во-вторых, повторное срабатывание ячейки могут вызвать темновые токи.
Каждый из этих трех процессов имеет экспоненциальное время распределения со своим собственным временем $\tau$:
\begin{eqnarray}\label{eq:f(dt)_afterpulsing}
f(\Delta t) = \frac{1}{\tau} \cdot \exp(-\Delta t / \tau),
\end{eqnarray}
где $\tau$ - среднее время, проходящее между двумя импульсами при рассмотрении лишь одного из вышеперечисленных эффектов.
Измерив расстояния между сигналами и аппроксимировав плотность вероятности временных интервалов аналитической функцией можно найти постоянные времени и вероятности процессов, приводящих к срабатыванию.

Поскольку мы интересуемся плотностью временных интервалов, то необходимо узнать вероятность $P(t)$ того, что на участке от $0$ до $t$ не должно быть импульсов, а на участке от $t$ до $t + \delta t$ должен произойти один импульс.

Если рассматривать лишь один экспоненциальный процесс, то эта вероятность есть $P_{exp}(t) =  \nu \cdot e^{- t \cdot \nu} \cdot \delta t$.

Выведем плотность вероятности для временных интервалов, если в ячейке могут происходить послеимпульсы или темновые импульсы.
Для начала рассмотрим случай, когда имеются послеимпульсы только одного типа, происходящие с вероятностью $p$ и частотой $\nu$.
Темновые импульсы, как и послеимпульсы имеют экспоненциальное распределение (\ref{eq:f(dt)_afterpulsing}).
Поскольку темновые импульсы не зависят от послеимпульсов, то искомую вероятность $P(t)$ можно записать следующим образом:

\begin{eqnarray}\label{eq:probability_dt_simple}
P(t) = P\{ \text{нет послеимпульсов от $0$ до $t + \delta t$} \} \cdot \\ \nonumber
P\{ \text{есть темновой импульс от $t$ до $t + \delta t$} \} +  \\ \nonumber
P\{ \text{есть послеимпульс от $t$ до $t + \delta t$} \} \cdot \\ \nonumber
P\{\text{нет темнового импульса от $0$ до $t + \delta t$} \}
\end{eqnarray}

Вклад каждого из процессов будет следующий:
\begin{eqnarray}\label{eq:probability_dt_simple_parts}
P\{ \text{нет послеимпульсов от $0$ до $t + \delta t$} \} = (1 - p) + p \cdot e^{- \nu \cdot t} \\ \nonumber
P\{ \text{есть темновой импульс от $t$ до $t + \delta t$} \} = (\nu_{dc} \cdot e^{- \nu_{dc} \cdot t}) \cdot \delta t \\ \nonumber
P\{ \text{есть послеимпульс от $t$ до $t + \delta t$} \} = p \cdot ( \nu \cdot e^{- \nu \cdot t} ) \cdot \delta t  \\ \nonumber
P\{\text{нет темнового импульса от $0$ до $t + \delta t$} \} = e^{- \nu_{dc} \cdot t} \\ \nonumber
\end{eqnarray}

Таким образом, подставив значения вероятностей из (\ref{eq:probability_dt_simple_parts}) в (\ref{eq:probability_dt_simple}) и сократив итоговое выражение на $\delta t$, получим плотность вероятности временных интервалов:
\begin{eqnarray}\label{eq:probability_dt_fast}
f(t) = p \cdot (\nu + \nu_{dc}) \cdot e^{-(\nu + \nu_{dc}) \cdot t} + (1 - p) \cdot \nu_{dc} \cdot e^{-\nu_{dc} \cdot t}
\end{eqnarray}

Стоит отметить, что аналогичная формула приведена в \cite{Using MPPCs for T2K Fine Grain Detector}, однако с опечаткой в знаке между слагаемыми.

В итоге при учете быстрых и медленных послеимпульсов и темновых токов плотность вероятности распределения временных интервалов запишется следующим образом:
\begin{eqnarray}\label{eq:dt_probability_fast_slow}
f(t) = p_{s} \cdot p_{f} \cdot (\nu_{s} + \nu_{f} + \nu_{dc} ) \cdot e^{- (\nu_{s} + \nu_{f} + \nu_{dc}) \cdot t} + \\ \nonumber
p_{s} \cdot (1 - p_{f}) \cdot (\nu_{s} + \nu_{dc}) \cdot e^{- (\nu_{s} + \nu_{dc}) \cdot t} + \\ \nonumber
p_{f} \cdot (1 - p_{s}) \cdot (\nu_{f} + \nu_{dc}) \cdot e^{- (\nu_{f} + \nu_{dc}) \cdot t} + \\ \nonumber
(1 - p_{s}) \cdot (1 - p_{f}) \cdot \nu_{dc} \cdot e^{- \nu_{dc} \cdot t}
\end{eqnarray}

Формула (\ref{eq:dt_probability_fast_slow}) действительна лишь в том случае, если измеряются расстояния между сигналами, вызванными срабатыванием одной ячейки.
Сигналы, вызванные одновременным срабатыванием двух и более ячеек (т.к. из-за кросстока) не должны рассматриваться при нахождении плотности временных интервалов.

В статье \cite{After-pulsingandcross-talkinmulti-pixelphotoncounters} приведен другой результат для плотности временных интервалов, отличный от полученного в данной работе,
т.к. они предполагали, что имеется еще один процесс - задержанный кроссток. Однако на практике вероятность задержанного кросстока значительно ниже, чем вероятность прямого кросстока и
в наших измерениях мы его не наблюдали. Про другие процессы, которые вызывают срабатывание ячейки можно найти в \cite{Modeling crosstalk and afterpulsing in siliconphoto multipliers}.


\section{Результаты}
\subsection{Темновой шум}
В результате аппроксимации спектра временных интервалов получены зависимости частоты темнового шума от температуры и перенапряжения (рис.\ref{image:Hamamatsu_S10362-11-100C_dc_vs_T}, \ref{image:Hamamatsu_S10362-11-100C_dc_vs_V}, \ref{image:Hamamatsu_S13360-3050CS_dc_vs_V_rus}, \ref{image:Hamamatsu_S13360-3050CS_dc_vs_V_rus}).
Зависимость частоты темновых токов от температуры выражается следующей формулой \cite{Characterization of SiPM: temperature dependencies}:
\begin{eqnarray}\label{eq:Hz_vs_temperature}
\nu(\Delta V = const, T) = A \cdot T^{3/2} \cdot \exp\left[ - \frac{E_g}{2 k_B \cdot T} \right],
\end{eqnarray}
где A - константа, зависящая от перенапряжения, материала и технологических параметров, T - абсолютная температура, $E_g$ - ширина запрещенной зоны, $k_B$ - константа Больцмана.
Зависимость частоты от перенапряжения выражается линейным законом:
\begin{eqnarray}\label{eq:Hz_vs_overvoltage}
\nu(\Delta V, T = const) = k \cdot \Delta V
\end{eqnarray}


\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_dc_vs_T_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_dc_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость частоты темнового тока от температуры при фиксированном перенапряжении для
Hamamatsu S10362-11-100C. Данные аппроксимированы функцией (\ref{eq:Hz_vs_temperature}).}
\label{image:Hamamatsu_S10362-11-100C_dc_vs_T}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость частоты темнового тока от перенапряжения при фиксированной температуре для
Hamamatsu S10362-11-100C. Данные аппроксимированы линейной функцией (\ref{eq:Hz_vs_overvoltage}).}
\label{image:Hamamatsu_S10362-11-100C_dc_vs_V}}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S13360-3050CS_dc_vs_V_eng}
\hfill
\includegraphics[width=0.47\textwidth]{KETEK_PM1125NS_SB0_dc_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость частоты темнового тока от перенапряжения при фиксированной температуре для Hamamatsu S13360-3050CS.
Линии - аппроксимация частоты константой для разных температур.}
\label{image:Hamamatsu_S13360-3050CS_dc_vs_V_rus}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость частоты темнового тока от перенапряжения при фиксированной температуре для KETEK PM1125NS-SB0.
Линия - аппроксимация частоты линейной функцией.}
\label{image:KETEK_PM1125NS_SB0_dc_vs_V_rus}}
\end{figure}

\subsection{Кроссток}

Результаты обработки приведены на рис. \ref{image:Hamamatsu_S10362-11-100C_xtalk_vs_T}, \ref{image:Hamamatsu_S10362-11-100C_xtalk_vs_V}, \ref{image:Hamamatsu_S13360-3050CS_xtalk_vs_V_rus}, \ref{image:KETEK_PM1125NS_SB0_x-tlak_vs_V_rus}.

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_xtalk_vs_T_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_xtalk_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности кросстока от температуры при фиксированном перенапряжении для
Hamamatsu S10362-11-100C.}
\label{image:Hamamatsu_S10362-11-100C_xtalk_vs_T}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности кросстока от перенапряжения при фиксированной температуре для
Hamamatsu S10362-11-100C. Данные аппроксимированы квадратичной функцией.}
\label{image:Hamamatsu_S10362-11-100C_xtalk_vs_V}}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S13360-3050CS_xtalk_vs_V_eng}
\hfill
\includegraphics[width=0.47\textwidth]{KETEK_PM1125NS_SB0_x-tlak_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности кросстока от перенапряжения при фиксированной температуре для
Hamamatsu S13360-3050CS. Данные аппроксимированы квадратичной функцией.}
\label{image:Hamamatsu_S13360-3050CS_xtalk_vs_V_rus}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности кросстока от перенапряжения при фиксированной температуре для
KETEK PM1125NS-SB0. Данные аппроксимированы квадратичной функцией.}
\label{image:KETEK_PM1125NS_SB0_x-tlak_vs_V_rus}}
\end{figure}


Исходя из экспериментальных данных, можно сделать вывод, что вероятность кросстока не зависит от температуры.

\subsection{Послеимпульсы}
В результате аппроксимации спектра временных интервалов мы находим также вероятности и времена послеимпульсов.
Полученные данные приведены на рис.~\ref{image:Hamamatsu_S10362-11-100C_p_f_vs_T}, \ref{image:Hamamatsu_S10362-11-100C_p_f_vs_V}, \ref{image:Hamamatsu_S10362-11-100C_p_s_vs_T}, \ref{image:Hamamatsu_S10362-11-100C_p_s_vs_V}, \ref{image:Hamamatsu_S13360-3050CS_p_f_vs_V_rus}, \ref{image:KETEK_PM1125NS_SB0_p_f_vs_V_rus}.

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_p_f_vs_T_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_p_f_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности быстрой компоненты послеимпульса $p_{f}$ от температуры при фиксированном перенапряжении для
Hamamatsu S10362-11-100C.}
\label{image:Hamamatsu_S10362-11-100C_p_f_vs_T}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности быстрой компоненты послеимпульса $p_{f}$ от перенапряжения при фиксированной температуре для
Hamamatsu S10362-11-100C. Данные аппроксимированы квадратичной функцией.}
\label{image:Hamamatsu_S10362-11-100C_p_f_vs_V}}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_p_s_vs_T_eng}
\hfill
\includegraphics[width=0.47\textwidth]{Hamamatsu_S10362-11-100C_p_s_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности медленной компоненты послеимпульса $p_{s}$ от температуры при фиксированном перенапряжении для
Hamamatsu S10362-11-100C.}
\label{image:Hamamatsu_S10362-11-100C_p_s_vs_T}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности медленной компоненты послеимпульса $p_{s}$ от перенапряжения при фиксированной температуре для
Hamamatsu S10362-11-100C. Данные аппроксимированы квадратичной функцией.}
\label{image:Hamamatsu_S10362-11-100C_p_s_vs_V}}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.47\textwidth]{Hamamatsu_S13360-3050CS_p_f_vs_V_eng}
\hfill
\includegraphics[width=0.47\textwidth]{KETEK_PM1125NS_SB0_p_f_vs_V_eng}
\\
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности быстрой компоненты послеимпульса $p_{f}$ от перенапряжения при фиксированной температуре для
Hamamatsu S13360-3050CS. Данные аппроксимированы квадратичной функцией.}
\label{image:Hamamatsu_S13360-3050CS_p_f_vs_V_rus}}
\hfill
\parbox[t]{0.47\textwidth}{\caption{Зависимость вероятности быстрой компоненты послеимпульса $p_{f}$ от перенапряжения при фиксированной температуре для
KETEK PM1125NS-SB0. Данные аппроксимированы квадратичной функцией.}
\label{image:KETEK_PM1125NS_SB0_p_f_vs_V_rus}}
\end{figure}


\section{Выводы}
В работе описан алгоритм измерения напряжения пробоя, темновых токов, вероятности кросстоков и послеимпульсов, времен послеимпульсов для трех типов SiPM :
KETEK PM1125NS-SB0, Hamamatsu S10362-33-025C and Hamamatsu S13360-3050CS.

При достигнутой точности измерения в интервале температур от $0$ до $20 C^{\circ}$ вероятность кросстока, вероятность послеимпульса и время послеимпульса не зависят от температуры.
Вероятность кросстока для Hamamatsu S10362-33-025C при рабочем перенапряжении (1 В) составляет около 12\%, для Hamamatsu S13360-3050CS и KETEK PM1125NS-SB0 (рабочее перенапряжение 4 В) состаляет около 6\%. Вероятность послеимпульса для Hamamatsu S10362-33-025C при рабочем перенапряжении составляет около 10\% (быстрая компонента) и 15\% (медленная компонента).
Для Hamamatsu S13360-3050CS и KETEK PM1125NS-SB0 из-за небольшой статистики была изучена только быстрая компонента, которая составляет около 10\%.
Время послеимпульса для Hamamatsu S10362-33-025C составляет около 35 нс (быстрая компонента) и 170 нс (медленная компонента), для Hamamatsu S13360-3050CS - 9 нс, для KETEK PM1125NS-SB0 - 28 нс.
Частота темновых шумов для Hamamatsu S10362-33-025C при рабочем напряжении и температуре $20  \;  ^{\circ}C$ составляет $300  \;  кГц / мм^2$, для Hamamatsu S13360-3050CS - $30 \; кГц / мм^2$, для KETEK PM1125NS-SB0 - $80 \; кГц / мм^2$.

Таким образом, на основании проделанных экспериментов, мы можем сделать вывод, что лучшим кандидатом для использования в счетных детекторах среди исследованных SiPM является Hamamatsu S13360-3050CS, который при прочих равных имеет меньшую частоту темновых токов и наименьшее время послеимпульса.

